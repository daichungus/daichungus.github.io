<!DOCTYPE html>
<html>
<title>Touhou Linux Guide</title>
<body>
<h1>Touhou Linux Guide</h1>
<h2>By <a href="https://github.com/daichungus">Daichungus</a></h2>
<p id="last-updated"></p>
<script>
  document.getElementById("last-updated").textContent = "Last updated at " + document.lastModified;
</script>
<!--<a href="/touhoulinuxguide/pc98.html">PC-98 Touhou Linux Guide</a>-->
<h2>This is a work-in-progress!</h2>
<hr class="light">
<h1>Setup</h1>
<h2>Choosing a distro</h2>
    <p>Most major distros should work well with this guide.</p>
    <p>I use Fedora 42 with KDE for my personal setup, and have tested this process on Ubuntu 24.04 LTS with GNOME.</p>
    <p>My only recommendation is to choose a well-known, widely-supported, and stable distro, which includes but is not limited to the following:</p>
    <ul>
        <li><a href="https://linuxmint.com/">Linux Mint</a></li>
        <li><a href="https://ubuntu.com/desktop">Ubuntu</a></li>
        <li><a href="https://fedoraproject.org/">Fedora</a></li>
        <li><a href="https://www.debian.org/">Debian</a></li>
    </ul>
    <h3>NOTE: This guide does not cover Arch Linux!</h3>
<h2>Installing required software</h2>
    <ol>
        <li>Update your repository using your distro's included package manager.
            <p><b>Debian/Ubuntu/Linux Mint: </b></p>
            <p><code>sudo apt update && sudo apt upgrade</code></p>
            <p><b>Fedora: </b></p>
            <p><code>sudo dnf update</code></p>
        </li>
        <li>If not already included, <a href="https://flathub.org/setup">install flatpak and add the flathub repo.</a></li>
        <li>Install Wine and Lutris.
            <p><b>Debian/Ubuntu/Linux Mint: </b></p>
            <p><code>sudo apt install wine lutris</code></p>
            <p><b>Fedora: </b></p>
            <p><code>sudo dnf install wine lutris</code></p>
        </li>
        <li>Using flatpak, <a href="https://flathub.org/apps/net.davidotek.pupgui2">install ProtonUp-Qt.</a></li>
        <li>Open ProtonUp-Qt to install ProtonGE to Lutris.</li>
    </ol>
<hr class="light">
<h1>Installing THCRAP patches</h1>
    <h3>Skip this section if you do not want to play with THCRAP patches, or if you already have THCRAP patches installed.</h3>
    <p><b>IMPORTANT NOTE: </b><code>thcrap_loader.exe</code> is the actual program that applies patches to the Touhou games,
        while <code>thcrap.exe</code> is the THCRAP configuration tool, which allows you to download new patches and locate the 
        games.
    </p>
    <h2>Installation and setup</h2>
    <ol>
        <li><a href="https://www.thpatch.net/wiki/Touhou_Patch_Center:Download">Download the main THCRAP package from thpatch.net</a></li>
        <li>Unzip the package. There are two ways to do this:</li>
        <ul>
            <li>Use a GUI-based archive manager. Usually included with your distro. (Ark, File Roller, Engrampa, etc.)</li>
            <li>Use the <code>unzip</code> command. You may have to install it with your package manager. An example  of the command in use is shown below:
                <p><code>unzip thcrap.zip -d ~/yourname/Downloads/thcrap</code></p>
            </li>
        </ul>
        <li>THCRAP's nature allows you be to patch any Touhou game in any location. However, I <b> highly recommend placing the thcrap folder in the same location as your Touhou games.</b></li>
        <li>Open Lutris, then add "locally installed game".</li>
        <li>You can set the name to be whatever you want, but "THCRAP configuration" is enough. Choose Wine as the Runner.</li>
        <li>Locate <code>thcrap.exe</code> for the executable path. (NOT <code>thcrap_loader.exe</code>!).</li>
        <li>Set the working directory path to be the same folder <code>thcrap.exe</code> is located in.</li>
        <li>Locate your Wine prefix. Usually this is located as <code>~/.wine</code></li>
        <li>Do not use System wine for the Runner option. Choose GE-Proton.</li>
        <li>Press the save button and ensure the THCRAP configuration tool runs properly.</li>
    </ol>
    <p><b>NOTE: </b>if you want to run the THCRAP configuration tool with regular Wine, you have to install Mono to your Wine prefix. 
        This is because the THCRAP configuration tool depends on the .NET framework. Mono is the Linux equivalent of it. 
        <b>Without Mono, the THCRAP configuration tool will only display a bright pink window before closing itself.</b>
        However, due to the rather complex nature of setting up Mono as of writing, GE-Proton is recommended for most users in this guide.
    </p>
<hr class="light">
<h1>Adding and running the Touhou games</h1>
    <h2>Running vanilla Touhou</h2>
    <p>Read this if you want to play without THCRAP patches or vpatch.</p>
    <ol>
        <li>Open Lutris, then add "locally installed game".</li>
        <li>Enter the game name. Choose Wine as the Runner.</li>
        <li>Locate your game's exe (usually thXX.exe) for the executable path.</li>
        <li>Set the working directory path to be the same folder the game is located in.</li>
        <li>Locate your Wine prefix. Usually this is located as <code>~/.wine</code></li>
        <li>For Runner options, use System wine.</li>
        <li>Press the save button and ensure your game is running.</li>
    </ol>
    <h3>Running Touhou with vpatch</h3>
    <p>Read this if you want to play with vpatch.</p>
    <p><b>NOTE: The executable of EoSD should be renamed to <code>東方紅魔郷.exe</code></b></p>
    <p><b>NOTE:</b> While vpatch is not required for reducing input lag on Linux, it allows you to resize the game window, and allows you to adjust the speed of replays.</p>
    <ol>
        <li>Repeat the same first few steps as running vanilla Touhou.</li>
        <li>Locate <code>vpatch.exe</code> for the executable path. The executable, <code>vpatch.ini</code>, and the appropriate <code>vpatch_thXX.dll</code> file should be in the same directory as the game you want to add.</li>
        <li>Continue with the same steps as running vanilla Touhou.</li>
        <li>Press the save button and ensure your game is running. If you changed the window size in <code>vpatch.ini</code>, the game's window should be that size.</li>
    </ol>
    <h3>Running with existing THCRAP patches</h3>
    <p>Read this if you already have downloaded THCRAP patches. (e.g. moving your games from Windows)</p>
    <ol>
        <li>Repeat the same steps as running vanilla Touhou, but for the executable path in Game options, locate <code>thcrap_loader.exe</code></li>
        <li>
            <p>In the Arguments field, enter the <code>.js</code> file of your patch and the name game you want to run it with. 
            You can find all of your installed patches in the <code>config/</code> subfolder of your <code>thcrap/</code> folder.</p>
            <p>Example: <code>en.js th06</code> for EoSD with the English patch.</p>
        </li>
        <li>Ensure the working directory is the folder that contains <code>thcrap_loader.exe</code>.</li>
        <li>Press the save button and ensure your game is running. There should be a small window that has the name "Touhou Community Reliant Automatic Patcher".</li>
        <li>If your game loads with your desired patch, you've succeeded.</li>
    </ol>
<hr class="light">
<h1>Additional Resources</h1>
    <ul>
        <li><a href="https://en.touhouwiki.net/wiki/Running_in_Linux_and_macOS">Touhou Wiki guide</a></li>
        <li><a href="https://wiki.archlinux.org/title/Touhou">ArchWiki guide</a></li>
        <li><a href="https://www.thpatch.net/wiki/Touhou_Patch_Center:Wine_tips">Touhou Patch Center: Wine tips</a></li>
        <li><a href="https://www.thpatch.net/wiki/Touhou_Patch_Center:Download">General THCRAP guide</a></li>
        <li><a href="https://github.com/scriptkitties/fglt/blob/master/_guides/playing-zun-touhou-games-on-gnu-linux-with-wine.md">scriptkitties guide (Uses Arch and PlayOnLinux)</a></li>
        <li><a href="https://hisouten.koumakan.jp/wiki/Linux_support">Guide to running Hisoutensoku</a></li>
        <li><a href="https://touhouprojects.com/emulators/wine/">Directly using Wine to run Touhou games</a></li>
    </ul>
</body>
</html>